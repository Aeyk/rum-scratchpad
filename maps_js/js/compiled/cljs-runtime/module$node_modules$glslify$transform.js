shadow$provide.module$node_modules$glslify$transform=function(global,require,module,exports){var process=require("module$node_modules$process$browser"),falafel=require("module$node_modules$falafel$index"),duplexify=require("module$node_modules$duplexify$index"),through=require("module$node_modules$through2$through2"),concat=require("module$node_modules$concat_stream$index"),from=require("module$node_modules$from2$index"),gdeps=require("module$node_modules$glslify_deps$index"),gbundle=require("module$node_modules$glslify_bundle$index"),
path=require("module$node_modules$path_browserify$index"),seval=require("module$node_modules$static_eval$index"),resolve=require("module$node_modules$resolve$index"),gresolve=require("module$node_modules$glsl_resolve$index"),extend=require("module$node_modules$xtend$immutable"),glslfile0=path.join("/","index.js"),glslfile1=path.join("/","index"),parseOptions={ecmaVersion:10,sourceType:"module",allowReturnOutsideFunction:!0,allowImportExportEverywhere:!0,allowHashBang:!0};module.exports=function(file$jscomp$0,
opts$jscomp$0){function createDeps(opts){var depper=gdeps(opts),basedir=opts.cwd;depper.on("error",function(err){d$jscomp$0.emit("error",err)});depper.on("file",function(file){d$jscomp$0.emit("file",file)});opts=opts.transform||[];opts=Array.isArray(opts)?opts:[opts];opts.forEach(function(transform){transform=Array.isArray(transform)?transform:[transform];var name=transform[0];transform=transform[1]||{};transform.post?posts.push({name,opts:transform,base:basedir}):depper.transform(name,transform)});
return depper}function bundle(deps){var source=gbundle(deps);posts.forEach(function(tr){"function"===typeof tr.name?tr=tr.name:(tr=resolve.sync(tr.name,{basedir:tr.base||mdir}),tr=require(tr));(tr=tr(null,source,{post:!0}))&&(source=tr)});return source}if(".json"==path.extname(file$jscomp$0))return through();opts$jscomp$0||(opts$jscomp$0={});var posts=[],dir=path.dirname(file$jscomp$0),glvar=null,mdir=dir,evars={__dirname:dir,__filename:file$jscomp$0,require:{resolve}},d$jscomp$0=duplexify(),out=
from(function(){});d$jscomp$0.setReadable(out);d$jscomp$0.setWritable(concat({encoding:"string"},function(src){function onnode(node){if("Identifier"===node.type&&"require"===node.name&&"CallExpression"===node.parent.type&&node.parent.arguments[0]&&"Literal"===node.parent.arguments[0].type&&"path"===node.parent.arguments[0].value&&"VariableDeclarator"===node.parent.parent.type)evars.path=path;else if("Identifier"===node.type&&"require"===node.name&&"CallExpression"===node.parent.type&&node.parent.arguments[0]&&
"Literal"===node.parent.arguments[0].type&&(/^glslify(?:\/index(?:\.js)?)?/.test(node.parent.arguments[0].value)||"/"===path.resolve(dir,node.parent.arguments[0].value)||path.resolve(dir,node.parent.arguments[0].value)===glslfile0||path.resolve(dir,node.parent.arguments[0].value)===glslfile1)){node=node.parent.parent;var pp=node.parent;"CallExpression"===node.type&&"CallExpression"===pp.type?(pending++,callexpr(node,done)):"VariableDeclarator"===node.type?glvar=node.id.name:"MemberExpression"===node.type&&
"file"===node.property.name&&"CallExpression"===pp.type?(pending++,rcallfile(pp,done)):"MemberExpression"===node.type&&"compile"===node.property.name&&"CallExpression"===pp.type?(pending++,rcallcompile(pp,done)):"TaggedTemplateExpression"===node.type&&(pending++,tagexpr(node,done))}else"Identifier"===node.type&&node.name===glvar&&"CallExpression"===node.parent.type?(pending++,callexpr(node.parent,done)):"TaggedTemplateExpression"===node.type&&node.tag.name===glvar?(pending++,tagexpr(node,done)):"Identifier"===
node.type&&node.name===glvar&&"MemberExpression"===node.parent.type&&"file"===node.parent.property.name&&"CallExpression"===node.parent.parent.type&&node.parent.parent.arguments[0]?(pending++,callfile(node.parent.parent,done)):"Identifier"===node.type&&node.name===glvar&&"MemberExpression"===node.parent.type&&"compile"===node.parent.property.name&&"CallExpression"===node.parent.parent.type&&node.parent.parent.arguments[0]&&(pending++,callcompile(node.parent.parent,done))}function tagexpr(node,cb){var q=
node.quasi,shadersrc=q.quasis.map(function(s){return s.value.raw+"__GLX_PLACEHOLDER__"}).join(""),d=createDeps({cwd:mdir});d.inline(shadersrc,mdir,function(err$jscomp$0,deps){if(err$jscomp$0)return d.emit("error",err$jscomp$0);try{var bsrc=bundle(deps)}catch(err){return d.emit("error",err)}node.update(node.tag.source()+"("+JSON.stringify(bsrc.split("__GLX_PLACEHOLDER__"))+[""].concat(q.expressions.map(function(e){return e.source()})).join(",")+")");cb()})}function callexpr(p,cb){function ondeps(err$jscomp$0,
deps){if(err$jscomp$0)return d.emit("error",err$jscomp$0);try{var bsrc=bundle(deps)}catch(err){return d.emit("error",err)}p.update(p.callee.source()+"(["+JSON.stringify(bsrc)+"])");cb()}var marg=seval(p.arguments[0],evars),mopts=p.arguments[1]?seval(p.arguments[1],evars)||{}:{},d=createDeps(extend({cwd:mdir},mopts));/(void\s+main\s?\(.*\)|\n)/.test(marg)?d.inline(marg,mdir,ondeps):gresolve(marg,{basedir:mdir},function(err,res){err?d.emit("error",err):d.add(res,ondeps)})}function callcompile(p,cb){var mfile=
p.arguments[0].value;p.arguments[1]&&seval(p.arguments[1],evars);var d=createDeps({cwd:mdir});d.inline(mfile,mdir,function(err$jscomp$0,deps){if(err$jscomp$0)return d.emit("error",err$jscomp$0);try{var bsrc=bundle(deps)}catch(err){return d.emit("error",err)}p.update(glvar+"(["+JSON.stringify(bsrc)+"])");cb()})}function callfile(p,cb){function ondeps(err$jscomp$0,deps){if(err$jscomp$0)return d$jscomp$0.emit("error",err$jscomp$0);try{var bsrc=bundle(deps)}catch(err){return d$jscomp$0.emit("error",err)}p.update(glvar+
"(["+JSON.stringify(bsrc)+"])");cb()}gresolve(p.arguments[0].value,{basedir:mdir},function(err,res){if(err)return d.emit("error",err);err=p.arguments[1]?seval(p.arguments[1],evars)||{}:{};var d=createDeps(extend({cwd:path.dirname(res)},err));d.add(res,ondeps)})}function rcallfile(p,cb){function ondeps(err$jscomp$0,deps){if(err$jscomp$0)return d$jscomp$0.emit("error",err$jscomp$0);try{var bsrc=bundle(deps)}catch(err){return d$jscomp$0.emit("error",err)}p.update(p.callee.object.source()+"(["+JSON.stringify(bsrc)+
"])");cb()}var mfile=seval(p.arguments[0],evars);gresolve(mfile,{basedir:mdir},function(err,res){if(err)return d.emit("error",err);err=p.arguments[1]?seval(p.arguments[1],evars)||{}:{};var d=createDeps(extend({cwd:path.dirname(res)},err));d.add(res,ondeps)})}function rcallcompile(p,cb){var marg=seval(p.arguments[0],evars);p.arguments[1]&&seval(p.arguments[1],evars);var d=createDeps({cwd:mdir});d.inline(marg,mdir,function(err$jscomp$0,deps){if(err$jscomp$0)return d.emit("error",err$jscomp$0);try{var bsrc=
bundle(deps)}catch(err){return d.emit("error",err)}p.update(p.callee.object.source()+"(["+JSON.stringify(bsrc)+"])");cb()})}function done(){0===--pending&&(out.push(fout.toString()),out.push(null))}var pending=1;if(-1===src.indexOf("glslify"))out.push(src),out.push(null);else{[].concat(opts$jscomp$0.post||[]).concat(opts$jscomp$0.p||[]).forEach(function(post){post=Array.isArray(post)?post:[post];posts.push({name:post[0],opts:post[1]||{},base:process.cwd()})});try{var fout=falafel(src,parseOptions,
onnode)}catch(err){return d$jscomp$0.emit("error",err)}done()}}));return d$jscomp$0}}
//# sourceMappingURL=module$node_modules$glslify$transform.js.map
