shadow$provide.module$node_modules$$tonejs$piano$build$midi$MidiInput=function(global,require,module,exports){function _typeof(obj$jscomp$0){_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};return _typeof(obj$jscomp$0)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=
descriptor.enumerable||!1;descriptor.configurable=!0;"value"in descriptor&&(descriptor.writable=!0);Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps);staticProps&&_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"===typeof call))return call;if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return self}function _get(target$jscomp$0,property$jscomp$0,receiver$jscomp$0){_get="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){for(;!Object.prototype.hasOwnProperty.call(target,property)&&(target=_getPrototypeOf(target),null!==target););if(target)return property=Object.getOwnPropertyDescriptor(target,property),property.get?property.get.call(receiver):property.value};return _get(target$jscomp$0,property$jscomp$0,receiver$jscomp$0||target$jscomp$0)}function _getPrototypeOf(o$jscomp$0){_getPrototypeOf=
Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o$jscomp$0)}function _inherits(subClass,superClass){if("function"!==typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}});superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o$jscomp$0,
p$jscomp$0){_setPrototypeOf=Object.setPrototypeOf||function(o,p){o.__proto__=p;return o};return _setPrototypeOf(o$jscomp$0,p$jscomp$0)}Object.defineProperty(exports,"__esModule",{value:!0});exports.MidiInput=void 0;global=require("module$node_modules$events$events");var _webmidi=function(obj){return obj&&obj.__esModule?obj:{"default":obj}}(require("module$node_modules$webmidi$webmidi_min")),__awaiter=function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}
return new (P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};require=function(_EventEmitter){function MidiInput(){var deviceId=0<arguments.length&&void 0!==arguments[0]?arguments[0]:
"all";if(!(this instanceof MidiInput))throw new TypeError("Cannot call a class as a function");var _this=_possibleConstructorReturn(this,_getPrototypeOf(MidiInput).call(this));_this.deviceId=deviceId;MidiInput.enabled().then(function(){_webmidi["default"].addListener("connected",function(event){"input"===event.port.type&&_this._addListeners(event.port)});_webmidi["default"].addListener("disconnected",function(event){_this._removeListeners(event.port)});_webmidi["default"].inputs.forEach(function(input){return _this._addListeners(input)})});
return _this}_inherits(MidiInput,_EventEmitter);_createClass(MidiInput,[{key:"_addListeners",value:function(device){var _this2=this;MidiInput.connectedDevices.has(device.id)||(MidiInput.connectedDevices.set(device.id,device),this.emit("connect",this._inputToDevice(device)),device.addListener("noteon","all",function(event){"all"!==_this2.deviceId&&_this2.deviceId!==device.id||_this2.emit("keyDown",{note:"".concat(event.note.name).concat(event.note.octave),midi:event.note.number,velocity:event.velocity,
device:_this2._inputToDevice(device)})}),device.addListener("noteoff","all",function(event){"all"!==_this2.deviceId&&_this2.deviceId!==device.id||_this2.emit("keyUp",{note:"".concat(event.note.name).concat(event.note.octave),midi:event.note.number,velocity:event.velocity,device:_this2._inputToDevice(device)})}),device.addListener("controlchange","all",function(event){"all"!==_this2.deviceId&&_this2.deviceId!==device.id||"holdpedal"!==event.controller.name||_this2.emit(event.value?"pedalDown":"pedalUp",
{device:_this2._inputToDevice(device)})}))}},{key:"_inputToDevice",value:function(input){return{name:input.name,id:input.id,manufacturer:input.manufacturer}}},{key:"_removeListeners",value:function(event){if(MidiInput.connectedDevices.has(event.id)){var device=MidiInput.connectedDevices.get(event.id);this.emit("disconnect",this._inputToDevice(device));MidiInput.connectedDevices["delete"](event.id);device.removeListener("noteon");device.removeListener("noteoff");device.removeListener("controlchange")}}},
{key:"emit",value:function(event,data){return _get(_getPrototypeOf(MidiInput.prototype),"emit",this).call(this,event,data)}},{key:"on",value:function(event,listener){_get(_getPrototypeOf(MidiInput.prototype),"on",this).call(this,event,listener);return this}},{key:"once",value:function(event,listener){_get(_getPrototypeOf(MidiInput.prototype),"once",this).call(this,event,listener);return this}},{key:"off",value:function(event,listener){_get(_getPrototypeOf(MidiInput.prototype),"off",this).call(this,
event,listener);return this}}],[{key:"enabled",value:function(){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(MidiInput._isEnabled){_context.next=3;break}_context.next=3;return new Promise(function(done,error){_webmidi["default"].enable(function(e){e?error(e):(MidiInput._isEnabled=!0,done())})});case 3:case "end":return _context.stop()}},_callee)}))}},{key:"getDevices",
value:function(){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function _callee2(){return regeneratorRuntime.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,MidiInput.enabled();case 2:return _context2.abrupt("return",_webmidi["default"].inputs);case 3:case "end":return _context2.stop()}},_callee2)}))}}]);return MidiInput}(global.EventEmitter);exports.MidiInput=require;require.connectedDevices=new Map;require._isEnabled=!1}
//# sourceMappingURL=module$node_modules$$tonejs$piano$build$midi$MidiInput.js.map
